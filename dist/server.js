(()=>{"use strict";var e={64:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(t,"__esModule",{value:!0}),t.nonce=void 0,t.nonce={},r(o(608),t)},608:function(e,t,o){var n=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,o,s):r(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},r=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.YoteamMessageExtensionBot=void 0;const i=o(698),s=o(58),a=o(871),c=o(883);let u=class extends s.TeamsActivityHandler{constructor(e){super(),this._yoteamMessageExtension=new a.default,this.conversationState=e,this.dialogState=e.createProperty("dialogState"),this.dialogs=new c.DialogSet(this.dialogState),this.onMessage((e=>r(this,void 0,void 0,(function*(){if(e.activity.type===s.ActivityTypes.Message){let t=s.TurnContext.removeRecipientMention(e.activity);if(t=t.toLowerCase(),t.startsWith("hello"))return void(yield e.sendActivity("Oh, hello to you as well!"));t.startsWith("help")?yield e.sendActivity("Please refer to [this link](https://docs.microsoft.com/en-us/microsoftteams/platform/bots/what-are-bots) to see how to develop bots for Teams"):yield e.sendActivity("I'm terribly sorry, but my developer hasn't trained me to do anything yet...")}return this.conversationState.saveChanges(e)}))))}};n([(0,i.MessageExtensionDeclaration)("yoteamMessageExtension")],u.prototype,"_yoteamMessageExtension",void 0),u=n([(0,i.BotDeclaration)("/api/messages",new s.MemoryStorage,process.env.MICROSOFT_APP_ID,process.env.MICROSOFT_APP_PASSWORD)],u),t.YoteamMessageExtensionBot=u},871:function(e,t,o){var n=this&&this.__decorate||function(e,t,o,n){var r,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(i<3?r(s):i>3?r(t,o,s):r(t,o))||s);return i>3&&s&&Object.defineProperty(t,o,s),s},r=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=o(698);let s=class{onFetchTask(e,t){return r(this,void 0,void 0,(function*(){return Promise.resolve({type:"continue",value:{url:`https://${process.env.PUBLIC_HOSTNAME}/yoteamMessageExtension/action.html?name={loginHint}&tenant={tid}&group={groupId}&theme={theme}`,height:"large"}})}))}onSubmitAction(e,t){return r(this,void 0,void 0,(function*(){return console.log(t),Promise.resolve({type:"message",text:""})}))}onQuerySettingsUrl(e){return r(this,void 0,void 0,(function*(){return Promise.resolve({title:"yoteam Message Extension Configuration",value:`https://${process.env.PUBLIC_HOSTNAME}/yoteamMessageExtension/config.html?name={loginHint}&tenant={tid}&group={groupId}&theme={theme}`})}))}onSettings(e){return r(this,void 0,void 0,(function*(){return e.activity.value.state,Promise.resolve()}))}};s=n([(0,i.PreventIframe)("/yoteamMessageExtension/config.html"),(0,i.PreventIframe)("/yoteamMessageExtension/action.html")],s),t.default=s},58:e=>{e.exports=require("botbuilder")},883:e=>{e.exports=require("botbuilder-dialogs")},455:e=>{e.exports=require("compression")},142:e=>{e.exports=require("dotenv")},860:e=>{e.exports=require("express")},698:e=>{e.exports=require("express-msteams-host")},470:e=>{e.exports=require("morgan")},685:e=>{e.exports=require("http")},17:e=>{e.exports=require("path")}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,o),i.exports}(()=>{const e=o(860),t=o(685),n=o(17),r=o(470),i=o(698),s=o(455);o(142).config();const a=o(64),c=e(),u=process.env.port||process.env.PORT||3007;c.use(e.json({verify:(e,t,o,n)=>{e.rawBody=o.toString()}})),c.use(e.urlencoded({extended:!0})),c.set("views",n.join(__dirname,"/")),c.use(r("tiny")),c.use(s()),c.use("/scripts",e.static(n.join(__dirname,"web/scripts"))),c.use("/assets",e.static(n.join(__dirname,"web/assets"))),c.use((0,i.MsTeamsApiRouter)(a)),c.use((0,i.MsTeamsPageRouter)({root:n.join(__dirname,"web/"),components:a})),c.use("/",e.static(n.join(__dirname,"web/"),{index:"index.html"})),c.set("port",u),t.createServer(c).listen(u,(()=>{}))})()})();
//# sourceMappingURL=server.js.map