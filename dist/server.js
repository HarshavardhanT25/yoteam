(()=>{"use strict";var e={64:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(t,"__esModule",{value:!0}),t.nonce=void 0,t.nonce={},r(o(608),t)},608:function(e,t,o){var n=this&&this.__decorate||function(e,t,o,n){var r,s=arguments.length,i=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(s<3?r(i):s>3?r(t,o,i):r(t,o))||i);return s>3&&i&&Object.defineProperty(t,o,i),i},r=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function i(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.YoteamMessageExtensionBot=void 0;const s=o(698),i=o(974),a=o(58),c=o(871),u=o(883);i("msteams");let l=class extends a.TeamsActivityHandler{constructor(e){super(),this._yoteamMessageExtension=new c.default,this.conversationState=e,this.dialogState=e.createProperty("dialogState"),this.dialogs=new u.DialogSet(this.dialogState),this.onMessage((e=>r(this,void 0,void 0,(function*(){if(e.activity.type===a.ActivityTypes.Message){let t=a.TurnContext.removeRecipientMention(e.activity);if(t=t.toLowerCase(),t.startsWith("hello"))return void(yield e.sendActivity("Oh, hello to you as well!"));t.startsWith("help")?yield e.sendActivity("Please refer to [this link](https://docs.microsoft.com/en-us/microsoftteams/platform/bots/what-are-bots) to see how to develop bots for Teams"):yield e.sendActivity("I'm terribly sorry, but my developer hasn't trained me to do anything yet...")}return this.conversationState.saveChanges(e)}))))}};n([(0,s.MessageExtensionDeclaration)("yoteamMessageExtension")],l.prototype,"_yoteamMessageExtension",void 0),l=n([(0,s.BotDeclaration)("/api/messages",new a.MemoryStorage,process.env.MICROSOFT_APP_ID,process.env.MICROSOFT_APP_PASSWORD)],l),t.YoteamMessageExtensionBot=l},871:function(e,t,o){var n=this&&this.__decorate||function(e,t,o,n){var r,s=arguments.length,i=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(i=(s<3?r(i):s>3?r(t,o,i):r(t,o))||i);return s>3&&i&&Object.defineProperty(t,o,i),i},r=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function i(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(i,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const s=o(974),i=o(698),a=s("msteams");let c=class{onFetchTask(e,t){return r(this,void 0,void 0,(function*(){return Promise.resolve({type:"continue",value:{url:`https://${process.env.PUBLIC_HOSTNAME}/yoteamMessageExtension/action.html?name={loginHint}&tenant={tid}&group={groupId}&theme={theme}`,height:"large"}})}))}onSubmitAction(e,t){return r(this,void 0,void 0,(function*(){return console.log(t),Promise.resolve({type:"message",text:""})}))}onQuerySettingsUrl(e){return r(this,void 0,void 0,(function*(){return Promise.resolve({title:"yoteam Message Extension Configuration",value:`https://${process.env.PUBLIC_HOSTNAME}/yoteamMessageExtension/config.html?name={loginHint}&tenant={tid}&group={groupId}&theme={theme}`})}))}onSettings(e){return r(this,void 0,void 0,(function*(){const t=e.activity.value.state;return a(`New setting: ${t}`),Promise.resolve()}))}};c=n([(0,i.PreventIframe)("/yoteamMessageExtension/config.html"),(0,i.PreventIframe)("/yoteamMessageExtension/action.html")],c),t.default=c},58:e=>{e.exports=require("botbuilder")},883:e=>{e.exports=require("botbuilder-dialogs")},455:e=>{e.exports=require("compression")},974:e=>{e.exports=require("debug")},142:e=>{e.exports=require("dotenv")},860:e=>{e.exports=require("express")},698:e=>{e.exports=require("express-msteams-host")},470:e=>{e.exports=require("morgan")},685:e=>{e.exports=require("http")},17:e=>{e.exports=require("path")}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,o),s.exports}(()=>{const e=o(860),t=o(685),n=o(17),r=o(470),s=o(698),i=o(974),a=o(455),c=i("msteams");c("Initializing Microsoft Teams Express hosted App..."),o(142).config();const u=o(64),l=e(),p=process.env.port||process.env.PORT||3007;l.use(e.json({verify:(e,t,o,n)=>{e.rawBody=o.toString()}})),l.use(e.urlencoded({extended:!0})),l.set("views",n.join(__dirname,"/")),l.use(r("tiny")),l.use(a()),l.use("/scripts",e.static(n.join(__dirname,"web/scripts"))),l.use("/assets",e.static(n.join(__dirname,"web/assets"))),l.use((0,s.MsTeamsApiRouter)(u)),l.use((0,s.MsTeamsPageRouter)({root:n.join(__dirname,"web/"),components:u})),l.use("/",e.static(n.join(__dirname,"web/"),{index:"index.html"})),l.set("port",p),t.createServer(l).listen(p,(()=>{c(`Server running on ${p}`)}))})()})();
//# sourceMappingURL=server.js.map